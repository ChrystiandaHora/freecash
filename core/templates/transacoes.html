{% extends "base.html" %}
{% block content %}

<div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6">

  <!-- Header -->
  <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-gray-900">Transações</h1>
      <p class="text-sm text-gray-500">Filtre, encontre e revise suas movimentações.</p>
    </div>
  </div>

  <!-- Filters -->
  <form id="filtrosForm" method="get" class="bg-white border border-gray-100 rounded-2xl shadow-sm p-5">
    <div class="flex items-start justify-between gap-4">
      <div>
        <h2 class="text-sm font-semibold text-gray-900">Filtros</h2>
        <p class="text-xs text-gray-500">Refine por período, tipo, categoria e forma de pagamento.</p>
      </div>

      <div class="hidden sm:flex items-center gap-2">
        <a href="?" class="text-sm font-semibold text-gray-600 hover:text-gray-900">Limpar</a>
        <button class="rounded-xl bg-gray-900 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-800">
          Aplicar
        </button>
      </div>
    </div>

    <div class="mt-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">

      <div>
        <label class="block text-xs font-semibold text-gray-600 mb-1">Ano</label>
        <select name="ano"
                class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="">Todos</option>
          {% for a in anos %}
            <option value="{{ a }}" {% if request.GET.ano == a|stringformat:"s" %}selected{% endif %}>{{ a }}</option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-xs font-semibold text-gray-600 mb-1">Mês</label>
        <select name="mes"
                class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="">Todos</option>
          {% for m in meses %}
            <option value="{{ m }}" {% if request.GET.mes == m|stringformat:"s" %}selected{% endif %}>{{ m }}</option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-xs font-semibold text-gray-600 mb-1">Tipo</label>
        <select name="tipo"
                class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="">Todos</option>
          <option value="receita" {% if request.GET.tipo == "receita" %}selected{% endif %}>Receita</option>
          <option value="despesa" {% if request.GET.tipo == "despesa" %}selected{% endif %}>Despesa</option>
        </select>
      </div>

      <div>
        <label class="block text-xs font-semibold text-gray-600 mb-1">Categoria</label>
        <select name="categoria"
                class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="">Todas</option>
          {% for c in categorias %}
            <option value="{{ c.id }}" {% if request.GET.categoria == c.id|stringformat:"s" %}selected{% endif %}>
              {{ c.nome }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-xs font-semibold text-gray-600 mb-1">Forma de pagamento</label>
        <select name="forma_pagamento"
                class="w-full rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="">Todas</option>
          {% for f in formas_pagamento %}
            <option value="{{ f.id }}" {% if request.GET.forma_pagamento == f.id|stringformat:"s" %}selected{% endif %}>
              {{ f.nome }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <!-- Mobile actions -->
    <div class="mt-5 flex sm:hidden items-center gap-3">
      <a href="?" class="w-1/2 text-center rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50">
        Limpar
      </a>
      <button class="w-1/2 rounded-xl bg-gray-900 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-800">
        Aplicar
      </button>
    </div>

    <!-- Active filter chips -->
    <div class="mt-5 flex flex-wrap gap-2">
      {% if request.GET.ano %}
        <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
          Ano: {{ request.GET.ano }}
          <a href="?{% if request.GET.mes %}mes={{ request.GET.mes }}&{% endif %}{% if request.GET.tipo %}tipo={{ request.GET.tipo }}&{% endif %}{% if request.GET.categoria %}categoria={{ request.GET.categoria }}&{% endif %}{% if request.GET.forma_pagamento %}forma_pagamento={{ request.GET.forma_pagamento }}{% endif %}"
             class="text-gray-500 hover:text-gray-900">✕</a>
        </span>
      {% endif %}

      {% if request.GET.mes %}
        <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
          Mês: {{ request.GET.mes }}
          <a href="?{% if request.GET.ano %}ano={{ request.GET.ano }}&{% endif %}{% if request.GET.tipo %}tipo={{ request.GET.tipo }}&{% endif %}{% if request.GET.categoria %}categoria={{ request.GET.categoria }}&{% endif %}{% if request.GET.forma_pagamento %}forma_pagamento={{ request.GET.forma_pagamento }}{% endif %}"
             class="text-gray-500 hover:text-gray-900">✕</a>
        </span>
      {% endif %}

      {% if request.GET.tipo %}
        <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
          Tipo: {{ request.GET.tipo }}
          <a href="?{% if request.GET.ano %}ano={{ request.GET.ano }}&{% endif %}{% if request.GET.mes %}mes={{ request.GET.mes }}&{% endif %}{% if request.GET.categoria %}categoria={{ request.GET.categoria }}&{% endif %}{% if request.GET.forma_pagamento %}forma_pagamento={{ request.GET.forma_pagamento }}{% endif %}"
             class="text-gray-500 hover:text-gray-900">✕</a>
        </span>
      {% endif %}

      {% if request.GET.categoria %}
        <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
          Categoria: {{ request.GET.categoria }}
          <a href="?{% if request.GET.ano %}ano={{ request.GET.ano }}&{% endif %}{% if request.GET.mes %}mes={{ request.GET.mes }}&{% endif %}{% if request.GET.tipo %}tipo={{ request.GET.tipo }}&{% endif %}{% if request.GET.forma_pagamento %}forma_pagamento={{ request.GET.forma_pagamento }}{% endif %}"
             class="text-gray-500 hover:text-gray-900">✕</a>
        </span>
      {% endif %}

      {% if request.GET.forma_pagamento %}
        <span class="inline-flex items-center gap-2 rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
          Pagamento: {{ request.GET.forma_pagamento }}
          <a href="?{% if request.GET.ano %}ano={{ request.GET.ano }}&{% endif %}{% if request.GET.mes %}mes={{ request.GET.mes }}&{% endif %}{% if request.GET.tipo %}tipo={{ request.GET.tipo }}&{% endif %}{% if request.GET.categoria %}categoria={{ request.GET.categoria }}{% endif %}"
             class="text-gray-500 hover:text-gray-900">✕</a>
        </span>
      {% endif %}
    </div>
  </form>

  <!-- Table -->
  <div class="bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden">

    <!-- Table header -->
    <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between px-5 py-4 border-b border-gray-100">
      <div>
        <h3 class="text-sm font-semibold text-gray-900">Lista de transações</h3>
        <p class="text-xs text-gray-500">
          {% if total_count %}
            Mostrando {{ page_obj.start_index }} a {{ page_obj.end_index }} de {{ total_count }} registro(s).
          {% else %}
            Nada para exibir.
          {% endif %}
        </p>
      </div>

      <!-- Per page (separate GET form to avoid duplicate inputs) -->
      <form method="get" class="flex items-center gap-2">
        {% for key, value in request.GET.items %}
          {% if key != "per_page" and key != "page" %}
            <input type="hidden" name="{{ key }}" value="{{ value }}">
          {% endif %}
        {% endfor %}

        <label class="text-xs font-semibold text-gray-600">Por página</label>
        <select name="per_page"
                onchange="this.form.submit()"
                class="rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-900/10">
          <option value="5" {% if per_page == 5 %}selected{% endif %}>5</option>
          <option value="10" {% if per_page == 10 %}selected{% endif %}>10</option>
          <option value="25" {% if per_page == 25 %}selected{% endif %}>25</option>
          <option value="50" {% if per_page == 50 %}selected{% endif %}>50</option>
          <option value="100" {% if per_page == 100 %}selected{% endif %}>100</option>
          <option value="200" {% if per_page == 200 %}selected{% endif %}>200</option>
        </select>
      </form>
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full">
        <thead class="bg-gray-50">
          <tr class="text-left text-xs font-semibold text-gray-500">
            <th class="px-5 py-3">Descrição</th>
            <th class="px-5 py-3">Data</th>
            <th class="px-5 py-3">Tipo</th>
            <th class="px-5 py-3">Categoria</th>
            <th class="px-5 py-3">Pagamento</th>
            <th class="px-5 py-3 text-right">Valor</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-gray-100 text-sm">
          {% for t in transacoes %}
            <tr class="hover:bg-gray-50">
              <td class="px-5 py-4">
                <div class="font-semibold text-gray-900">
                  {{ t.descricao|default:"Sem descrição" }}
                </div>
                <div class="text-xs text-gray-500">ID #{{ t.id }}</div>
              </td>

              <td class="px-5 py-4 text-gray-700 whitespace-nowrap">
                {{ t.data|date:"d/m/Y" }}
              </td>

              <td class="px-5 py-4">
                {% if t.tipo == "R" %}
                  <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-700">
                    Receita
                  </span>
                {% else %}
                  <span class="inline-flex items-center rounded-full bg-red-100 px-3 py-1 text-xs font-semibold text-red-700">
                    Despesa
                  </span>
                {% endif %}
              </td>

              <td class="px-5 py-4 text-gray-700">
                {% if t.categoria %}
                  {{ t.categoria.nome }}
                {% else %}
                  <span class="text-gray-400">Sem categoria</span>
                {% endif %}
              </td>

              <td class="px-5 py-4 text-gray-700">
                {% if t.forma_pagamento %}
                  {{ t.forma_pagamento.nome }}
                {% else %}
                  <span class="text-gray-400">Não informado</span>
                {% endif %}
              </td>

              <td class="px-5 py-4 text-right font-semibold whitespace-nowrap {% if t.tipo == 'R' %}text-green-700{% else %}text-red-700{% endif %}">
                R$ {{ t.valor|floatformat:2 }}
              </td>
            </tr>
          {% empty %}
            <tr>
              <td class="px-5 py-10 text-center" colspan="6">
                <div class="mx-auto max-w-sm">
                  <p class="text-sm font-semibold text-gray-900">Nenhuma transação encontrada</p>
                  <p class="mt-1 text-sm text-gray-500">Tente limpar os filtros ou ajustar o período.</p>
                  <a href="?" class="mt-4 inline-flex items-center justify-center rounded-xl bg-gray-900 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-800">
                    Limpar filtros
                  </a>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    {% if page_obj.paginator.num_pages > 1 %}
  <div class="flex items-center justify-between border-t border-gray-100 bg-white px-5 py-4">

    <!-- Mobile -->
    <div class="flex flex-1 justify-between sm:hidden">
      {% if page_obj.has_previous %}
        <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ page_obj.previous_page_number }}"
           class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50">
          Anterior
        </a>
      {% else %}
        <span class="relative inline-flex items-center rounded-md border border-gray-200 bg-gray-50 px-4 py-2 text-sm font-semibold text-gray-400 cursor-not-allowed">
          Anterior
        </span>
      {% endif %}

      {% if page_obj.has_next %}
        <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ page_obj.next_page_number }}"
           class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50">
          Próxima
        </a>
      {% else %}
        <span class="relative inline-flex items-center rounded-md border border-gray-200 bg-gray-50 px-4 py-2 text-sm font-semibold text-gray-400 cursor-not-allowed">
          Próxima
        </span>
      {% endif %}
    </div>

    <!-- Desktop -->
    <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
      <div>
        <p class="text-sm text-gray-700">
          Mostrando
          <span class="font-semibold">{{ page_obj.start_index }}</span>
          até
          <span class="font-semibold">{{ page_obj.end_index }}</span>
          de
          <span class="font-semibold">{{ page_obj.paginator.count }}</span>
          resultados
        </p>
      </div>

      <div>
        {% with current=page_obj.number total=page_obj.paginator.num_pages last=page_obj.paginator.num_pages last1=page_obj.paginator.num_pages|add:"-1" last2=page_obj.paginator.num_pages|add:"-2" %}
          <nav aria-label="Paginação" class="isolate inline-flex -space-x-px rounded-md shadow-sm">

            <!-- Previous arrow -->
            {% if page_obj.has_previous %}
              <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ page_obj.previous_page_number }}"
                 class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                <span class="sr-only">Anterior</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z" />
                </svg>
              </a>
            {% else %}
              <span class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-300 ring-1 ring-inset ring-gray-200 bg-gray-50 cursor-not-allowed">
                <span class="sr-only">Anterior</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z" />
                </svg>
              </span>
            {% endif %}

            <!-- Start chunk: 1,2,3 -->
            {% if 1 == current %}
              <span aria-current="page"
                    class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">1</span>
            {% else %}
              <a href="?{% if querystring %}{{ querystring }}&{% endif %}page=1"
                 class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">1</a>
            {% endif %}

            {% if total >= 2 %}
              {% if 2 == current %}
                <span aria-current="page"
                      class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">2</span>
              {% else %}
                <a href="?{% if querystring %}{{ querystring }}&{% endif %}page=2"
                   class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">2</a>
              {% endif %}
            {% endif %}

            {% if total >= 3 %}
              {% if 3 == current %}
                <span aria-current="page"
                      class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">3</span>
              {% else %}
                <a href="?{% if querystring %}{{ querystring }}&{% endif %}page=3"
                   class="relative hidden md:inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">3</a>
              {% endif %}
            {% endif %}

            <!-- Ellipsis after start chunk -->
            {% if total > 6 and current > 4 %}
              <span class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300">
                ...
              </span>
            {% endif %}

            <!-- Middle chunk: current-1, current, current+1 (sem colidir com começo/fim) -->
            {% with p_prev=current|add:"-1" p_next=current|add:"1" %}
              {% if total > 6 %}
                {% if p_prev > 3 and p_prev < last2 %}
                  <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ p_prev }}"
                     class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                    {{ p_prev }}
                  </a>
                {% endif %}

                {% if current > 3 and current < last2 %}
                  <span aria-current="page"
                        class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
                    {{ current }}
                  </span>
                {% endif %}

                {% if p_next > 3 and p_next < last2 %}
                  <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ p_next }}"
                     class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                    {{ p_next }}
                  </a>
                {% endif %}
              {% endif %}
            {% endwith %}

            <!-- Ellipsis before end chunk -->
            {% if total > 6 and current < total|add:"-3" %}
              <span class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300">
                ...
              </span>
            {% endif %}

            <!-- End chunk: last-2, last-1, last -->
            {% if total > 3 %}
              {% if last2 > 3 %}
                {% if last2 == current %}
                  <span aria-current="page"
                        class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
                    {{ last2 }}
                  </span>
                {% else %}
                  <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ last2 }}"
                     class="relative hidden md:inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                    {{ last2 }}
                  </a>
                {% endif %}
              {% endif %}

              {% if last1 > 3 %}
                {% if last1 == current %}
                  <span aria-current="page"
                        class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
                    {{ last1 }}
                  </span>
                {% else %}
                  <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ last1 }}"
                     class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                    {{ last1 }}
                  </a>
                {% endif %}
              {% endif %}

              {% if last > 3 %}
                {% if last == current %}
                  <span aria-current="page"
                        class="relative z-10 inline-flex items-center bg-gray-900 px-4 py-2 text-sm font-semibold text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900">
                    {{ last }}
                  </span>
                {% else %}
                  <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ last }}"
                     class="relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                    {{ last }}
                  </a>
                {% endif %}
              {% endif %}
            {% endif %}

            <!-- Next arrow -->
            {% if page_obj.has_next %}
              <a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ page_obj.next_page_number }}"
                 class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0">
                <span class="sr-only">Próxima</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" />
                </svg>
              </a>
            {% else %}
              <span class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-300 ring-1 ring-inset ring-gray-200 bg-gray-50 cursor-not-allowed">
                <span class="sr-only">Próxima</span>
                <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" />
                </svg>
              </span>
            {% endif %}

          </nav>
        {% endwith %}
      </div>
    </div>

  </div>
{% endif %}


  </div>

</div>

{% endblock %}
